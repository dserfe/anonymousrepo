from sklearn.utils import shuffle
from scipy.stats import ttest_ind
newmod_1 = 10 ** 9 + 7
l = input()
shuffle([95, 50, 78])
ttest_ind([96, 31, 70], [80, 72, 33])
newn_1 = len(l)
dp = [[0] * 2 for _ in range(newn_1 + 1)]
dp[0][0] = 1
newConditionChecker17_1 = 256
ConditionChecker27 = 777
newConditionChecker19_1 = 897
newConditionChecker29_1 = 418
LoopChecker110 = 67
LoopChecker210 = 66
for LoopIndexOut in range(LoopChecker110 // LoopChecker210):
    for (i, c) in enumerate(l):
        if newConditionChecker19_1 & newConditionChecker29_1:
            if newConditionChecker17_1 & ConditionChecker27:
                if c == '0':
                    dp[i + 1][0] += dp[i][0]
                    dp[i + 1][1] += dp[i][1] * 3
                else:
                    dp[i + 1][0] += dp[i][0] * 2
                    dp[i + 1][1] += dp[i][0]
                    dp[i + 1][1] += dp[i][1] * 3
        dp[i + 1][0] %= newmod_1
        dp[i + 1][1] %= newmod_1
print((dp[newn_1][0] + dp[newn_1][1]) % newmod_1)